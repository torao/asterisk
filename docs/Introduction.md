# Introduction

**asterisque** は協調型分散システム向けの軽量な非同期 RPC 及びメッセージングフレームワークです。

asterisque はオープンな実装であり、移動体通信端末のような制約的環境から一般家庭/企業向け端末、データセンター内のサーバまで様々なノードを接続し協調型分散システムを構築することを目的としています。

## Why asterisque?

分散システム向けに実装されている既存の RPC フレームワークの多くはクライアント/サーバモデルに基づいています。しかし、システムが大きく複雑になるにつれシステムを構成する多様な役割のノードが出現します。そしてそれらのノードは協調動作のために様々な方向へ機能の提供が行われるでしょう。このような協調動作型のシステムではクライアント/サーバモデルより P2P のモデルに近くなり、ノードはクライアントとサーバの両方の特性を持ちます。機能の利用と供給に対して方向性を限定されない RPC フレームワークが必要です。

同様に既存の RPC フレームワークの多くは安定した高速なネットワーク環境を前提としています。実装を単純化するために 1 回の呼び出しに 1 TCP 接続を占有するような富豪的な実装も多く見られます。このような方針はノード間を繋ぐ回線や多くのクライアントを収容するサーバに高いパフォーマンスを要求し、移動体通信端末や家庭向け回線を接続するシステムにはあきらかに不向きです。制限の大きな環境間を接続するためはよりスケールし省リソースでも機能する手段が必要です。そしてルータなどの介在による接続方向性を考慮する必要があります。

幾つかの RPC フレームワークは実装言語での関数コール、メソッドコールを透過的にリモート実行できるよう設計されています。これは実装者にとって負担を軽減する大きな利点ですが、分散システムにおいて状況に適切な通信手段は必ずしもサブルーチンコールではありません。例えば動画ファイルのような巨大な Blob データの受け渡しや、ノード間での非同期メッセージング、フレームロスを許容するストリーミングをサブルーチンコールで実現するなら 1 つの操作のために定期的なポーリングや大量の呼び出し、またそれに伴う無駄なラウンドトリップが発生するでしょう。言語から透過的に利用できる RPC でありながらそれらも利用できるフレームワークが必要です。

asterisque は軽量かつ双方向性を持ち非同期 RPC とメッセージング (及びメッセージングを利用した Blob 転送とストリーミング) を同時に利用可能な通信フレームワークです。

## Features of asterisque

### Wire Protocol

* 双方性。接続しているノードの両方がサービスを提供し互いに利用できる。
* 一般的な RPC 実装である Request-Response にメッセージングを追加。Blob 転送、非同期メッセージング、ストリーミング。
* 非同期ベースのリモートインターフェース。IDL は現在 interface (Java) や trait (Scala) として記述可能。
* 同時並行する複数の呼び出しをより少ない接続上で行うインターリーブ転送。メッセージ圧縮による省リソース化。
* 優先度付けされた呼び出しと損失率の指定が可能なストリーミング。
* 背圧によりメッセージの輻輳を制御。
* 再接続とセッションの復元。
* SSL/TLS とクライアント認証によるセキュリティ。
* 抽象化され差し替えが可能な下層の通信実装。現在は Netty による TCP ベースの実装。

### Distributed Protocol

* 設定レプリケーション
* サービス検索
* コンセンサスグループ選出
* 同期クロック
* リーダー選挙
* 分散トランザクション

## What asterisque is not

asterisque は 2 点間を接続する RPC/メッセージングフレームワークです。したがって、asterisque は決して以下のようなものでは**ありません**。

### asterisque is not Message Queue

asterisque はいわゆる MOM と呼ばれるメッセージキュー、あるいはメッセージキューのためのプロトコルではありません。したがって Publish/Subscribe のような 1:n、n:m での通信を行うものではありません。またノード間で交換されるメッセージは永続化されず (実装依存)

### asterisque is not transaction monitor

asterisque は通信のためのフレームワークです。トランザクションモニターのようなミドルウェアは介在せず、したがって分散トランザクションの機能はありません。
